pipeline {
agent any

```
environment {
    // Replace this with your GitHub credentials ID from Jenkins
    GITHUB_CREDENTIALS = 'github-creds'
    // Optional: Python virtual environment directory
    VENV_DIR = '.venv'
}

stages {
    stage('Checkout Code') {
        steps {
            git(
                url: 'https://github.com/your-username/alx-backend-python.git',
                branch: 'main',
                credentialsId: GITHUB_CREDENTIALS
            )
        }
    }

    stage('Set Up Python Environment') {
        steps {
            // ShiningPanda provides the 'python' block for virtualenvs
            python {
                sh """
                python3 -m venv ${VENV_DIR}
                source ${VENV_DIR}/bin/activate
                pip install --upgrade pip
                pip install -r messaging_app/requirements.txt
                """
            }
        }
    }

    stage('Run Tests') {
        steps {
            python {
                sh """
                source ${VENV_DIR}/bin/activate
                pytest messaging_app/tests/ --junitxml=report.xml
                """
            }
        }
    }

    stage('Publish Test Report') {
        steps {
            junit 'report.xml'
        }
    }
}

post {
    always {
        echo 'Cleaning up...'
        deleteDir()
    }
    success {
        echo '✅ All tests passed successfully!'
    }
    failure {
        echo '❌ Some tests failed. Please check the report.'
    }
}
```

}
